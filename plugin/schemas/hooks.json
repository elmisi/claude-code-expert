{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Valid hook configuration for Claude Code",
  "validEvents": [
    "SessionStart",
    "SessionEnd",
    "UserPromptSubmit",
    "PreToolUse",
    "PostToolUse",
    "PostToolUseFailure",
    "PermissionRequest",
    "Notification",
    "Stop",
    "PreCompact",
    "SubagentStart",
    "SubagentStop",
    "TeammateIdle",
    "TaskCompleted",
    "ConfigChange"
  ],
  "validTypes": ["command", "prompt", "agent"],
  "hookHandlerFields": {
    "common": {
      "type": {
        "type": "string",
        "required": true,
        "validValues": ["command", "prompt", "agent"],
        "default": "command"
      },
      "timeout": {
        "type": "integer",
        "description": "Timeout in milliseconds. Defaults: command=600000, prompt=30000, agent=60000",
        "required": false
      },
      "async": {
        "type": "boolean",
        "description": "Run hook in background without blocking Claude. Only for command type.",
        "default": false,
        "required": false
      },
      "statusMessage": {
        "type": "string",
        "description": "Custom spinner message shown while the hook runs",
        "required": false
      }
    },
    "command": {
      "command": {
        "type": "string",
        "required": true,
        "description": "Shell command to execute"
      }
    },
    "prompt": {
      "prompt": {
        "type": "string",
        "required": true,
        "description": "Text prompt for single-turn LLM evaluation"
      },
      "model": {
        "type": "string",
        "required": false,
        "description": "Model to use for evaluation (default: haiku)",
        "validValues": ["opus", "sonnet", "haiku"]
      }
    },
    "agent": {
      "prompt": {
        "type": "string",
        "required": true,
        "description": "Text prompt for multi-turn agent verification"
      },
      "model": {
        "type": "string",
        "required": false,
        "description": "Model to use for the agent (default: haiku)",
        "validValues": ["opus", "sonnet", "haiku"]
      }
    }
  },
  "matchersByEvent": {
    "PreToolUse": {
      "description": "Tool name pattern",
      "examples": ["Bash", "Edit", "Write", "Edit|Write", "Read", "Glob", "Grep", "WebFetch", "WebSearch", "Task", "NotebookEdit", "mcp__.*", "mcp__github__.*"]
    },
    "PostToolUse": {
      "description": "Tool name pattern (same as PreToolUse)",
      "examples": ["Bash", "Edit", "Write", "Edit|Write", "Read", "Glob", "Grep", "mcp__.*"]
    },
    "PostToolUseFailure": {
      "description": "Tool name pattern (same as PreToolUse)",
      "examples": ["Bash", "Edit", "Write"]
    },
    "PermissionRequest": {
      "description": "Tool name pattern",
      "examples": ["Bash", "Edit|Write", "mcp__.*"]
    },
    "SessionStart": {
      "description": "How the session started",
      "validValues": ["startup", "resume", "clear", "compact"]
    },
    "SessionEnd": {
      "description": "Why the session ended",
      "validValues": ["clear", "logout", "prompt_input_exit", "bypass_permissions_disabled", "other"]
    },
    "Notification": {
      "description": "Notification type",
      "validValues": ["permission_prompt", "idle_prompt", "auth_success", "elicitation_dialog"],
      "note": "Empty string matches all"
    },
    "SubagentStart": {
      "description": "Agent type",
      "examples": ["Bash", "Explore", "Plan", "general-purpose", "custom-agent-name"]
    },
    "SubagentStop": {
      "description": "Agent type (same as SubagentStart)",
      "examples": ["Bash", "Explore", "Plan", "general-purpose"]
    },
    "PreCompact": {
      "description": "What triggered compaction",
      "validValues": ["manual", "auto"]
    },
    "UserPromptSubmit": {
      "description": "No matcher support - always fires",
      "note": "Matcher is ignored for this event"
    },
    "Stop": {
      "description": "No matcher support - always fires",
      "note": "Matcher is ignored for this event"
    },
    "TeammateIdle": {
      "description": "Agent team teammate about to go idle",
      "examples": ["agent-name", "frontend", "backend"],
      "note": "Matcher is the agent name. Exit 2 only (no hookSpecificOutput support)"
    },
    "TaskCompleted": {
      "description": "Task being marked completed",
      "note": "No matcher support. Exit 2 only (no hookSpecificOutput support)"
    },
    "ConfigChange": {
      "description": "Config file changed during session",
      "validValues": ["user_settings", "project_settings", "local_settings", "policy_settings", "skills"],
      "note": "Matcher is the config type that changed"
    }
  },
  "capabilities": {
    "updatedInput": {
      "description": "PreToolUse hooks can modify tool inputs before execution",
      "events": ["PreToolUse"],
      "usage": "Return JSON with hookSpecificOutput.updatedInput to rewrite tool arguments",
      "example": {
        "hookSpecificOutput": {
          "updatedInput": {
            "command": "modified-command"
          }
        }
      }
    },
    "permissionDecision": {
      "description": "PermissionRequest hooks can control permission decisions",
      "events": ["PermissionRequest"],
      "usage": "Return hookSpecificOutput.decision with behavior (allow/deny), updatedInput, updatedPermissions, message"
    }
  },
  "exitCodes": {
    "0": "Allow/proceed with the action",
    "2": "Block the action (stderr becomes Claude's feedback)",
    "other": "Allow but log error (visible in verbose mode)"
  },
  "structure": {
    "description": "Correct JSON structure for hooks",
    "example": {
      "hooks": {
        "EVENT_NAME": [
          {
            "matcher": "optional_pattern",
            "hooks": [
              {
                "type": "command",
                "command": "your-shell-command"
              }
            ]
          }
        ]
      }
    }
  },
  "environmentVariables": {
    "CLAUDE_TOOL_INPUT": "JSON string of tool input (for PreToolUse/PostToolUse)",
    "CLAUDE_PROJECT_DIR": "Project directory path",
    "CLAUDE_SESSION_ID": "Current session ID",
    "CLAUDE_ENV_FILE": "File path for persisting environment variables (SessionStart hooks)",
    "CLAUDE_PLUGIN_ROOT": "Root directory of the plugin (for referencing bundled scripts)",
    "CLAUDE_CODE_REMOTE": "Set to 'true' when running in remote/web environments"
  },
  "invalidEvents": {
    "description": "These event names DO NOT EXIST - never use them",
    "examples": ["PreCommit", "PostCommit", "PreBash", "PostBash", "PreEdit", "PostEdit", "BeforeToolUse", "AfterToolUse"]
  }
}
